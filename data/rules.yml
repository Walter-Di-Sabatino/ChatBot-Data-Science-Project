rules:

  - rule: get game info
    condition:
      - active_loop: null 
    steps:
      - intent: game_info
      - action: game_info_form
      - active_loop: game_info_form
      - slot_was_set:
          - requested_slot: game
      - slot_was_set:
          - requested_slot: null
      - active_loop: null
      - action: action_provide_game_info
      - action: action_reset_slots

  - rule: get publishers games
    condition:
      - active_loop: null 
    steps:
      - intent: get_publisher_games
      - action: get_publisher_games_form
      - active_loop: get_publisher_games_form
      - slot_was_set:
          - requested_slot: publishers
      - slot_was_set:
          - requested_slot: null
      - active_loop: null
      - action: action_provide_publisher_games
      - action: action_reset_slots

  - rule: get genres
    steps:
      - intent: get_genres
      - action: action_provide_genres

  - rule: get publishers
    steps:
      - intent: get_publishers
      - action: action_provide_publishers
  
  - rule: activate detailed recommendation form
    steps:
      - intent: ask_recommendation
      - action: detailed_recommendation_form
      - active_loop: detailed_recommendation_form

  - rule: provide recommendation
    condition:
      - active_loop: detailed_recommendation_form
      - slot_was_set:
          - genres_filter
      - slot_was_set:
          - genres
      - slot_was_set:
          - publishers_filter
      - slot_was_set:
          - publishers
    steps:
      - active_loop: null
      - action: action_provide_recommendation
      - action: action_reset_slots

  - rule: Handle interruption intents during forms
    condition:
      - active_loop: detailed_recommendation_form
    steps:
      - intent: game_info
      - action: utter_no_form_in_form
      - action: action_resume_form

  - rule: Handle interruption intents during forms (publishers games)
    condition:
      - active_loop: detailed_recommendation_form
    steps:
      - intent: get_publisher_games
      - action: utter_no_form_in_form
      - action: action_resume_form

  - rule: activate termination
    condition: 
      - active_loop: detailed_recommendation_form
    steps: 
      - intent: terminate
      - action: utter_ask_continue

  - rule: deactivate detailed recommendation form
    condition: 
      - active_loop: detailed_recommendation_form
    steps:
      - action: utter_ask_continue 
      - intent: positive
      - action: action_deactivate_loop
      - active_loop: null
      - action: utter_terminate_form
      - action: action_reset_slots

  - rule: handle termination interruption
    condition: 
      - active_loop: detailed_recommendation_form
    steps:
      - action: utter_ask_continue
      - intent: negative
      - action: action_resume_form

  - rule: start
    steps:
      - intent: start
      - action: utter_iamabot

  - rule: Greet the user
    steps:
      - intent: greet
      - action: utter_greet

  - rule: Say goodbye anytime the user says goodbye
    steps:
    - intent: goodbye
    - action: utter_goodbye

  - rule: Say 'I am a bot' anytime the user challenges
    steps:
      - intent: bot_challenge
      - action: utter_iamabot